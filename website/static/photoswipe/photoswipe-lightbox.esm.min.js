/*!
  * PhotoSwipe Lightbox 5.0.0 - https://photoswipe.com
  * (c) 2021 Dmitry Semenov
  */
new Image;const t=3e3;class i{constructor(t,i,s){this.options=t,this.itemData=i,this.index=s}update(t,i,s){this.elementSize={x:t,y:i},this.panAreaSize=s;const n=this.panAreaSize.x/this.elementSize.x,e=this.panAreaSize.y/this.elementSize.y;this.fit=Math.min(1,n<e?n:e),this.fill=Math.min(1,n>e?n:e),this.vFill=Math.min(1,e),this.initial=this.t(),this.secondary=this.i(),this.max=Math.max(this.initial,this.secondary,this.s()),this.min=Math.min(this.fit,this.initial,this.secondary)}o(t){const i=this.options[t+"ZoomLevel"];if(i)return"function"==typeof i?i(this):"fill"===i?this.fill:"fit"===i?this.fit:Number(i)}i(){let i=this.o("secondary");return i||((i=Math.min(1,2.5*this.fit))*this.elementSize.x>t&&(i=t/this.elementSize.x),i)}t(){return this.o("initial")||this.fit}s(){const t=this.o("max");return t||Math.max(1,4*this.fit)}}function s(t,s){const n=s.getItemData(t);if(!s.dispatch("lazyLoadSlide",{index:t,itemData:n}).defaultPrevented&&n.src&&n.w&&n.h){const{options:e}=s,h=s.viewportSize||function(t,i){if(t.getViewportSizeFn){const s=t.getViewportSizeFn(t,i);if(s)return s}return{x:document.documentElement.clientWidth,y:window.innerHeight}}(e),o=function(t,i){return{x:i.x-(t.paddingLeft||0)-(t.paddingRight||0),y:i.y-(t.paddingTop||0)-(t.paddingBottom||0)}}(e,h),r=new i(e,n,t);r.update(n.w,n.h,o);const c=document.createElement("img");c.decoding="async",c.sizes=Math.ceil(n.w*r.initial)+"px",c.src=n.src,n.srcset&&(c.srcset=n.srcset)}}function n(t){return import(t)}function e(t){return new Promise((i,s)=>{let n=document.head.querySelector(`link[href="${t}"]`);if(n){if(n.dataset.loaded)return void i()}else(n=document.createElement("link")).rel="stylesheet",n.href=t,n.media="all",document.head.appendChild(n);n.onload=(()=>{n.dataset.loaded=!0,requestAnimationFrame(()=>i())}),n.onerror=(()=>{n.remove(),s()})})}class h{constructor(t,i){this.type=t,i&&Object.assign(this,i)}preventDefault(){this.defaultPrevented=!0}}class o{constructor(){this.u={}}on(t,i){this.u[t]||(this.u[t]=[]),this.u[t].push(i),this.pswp&&this.pswp.on(t,i)}off(t,i){this.u[t]&&(this.u[t]=this.u[t].filter(t=>i!==t)),this.pswp&&this.pswp.off(t,i)}dispatch(t,i){if(this.pswp)return this.pswp.dispatch(t,i);const s=new h(t,i);return this.u?(this.u[t]&&this.u[t].forEach(t=>{t.call(this,s)}),s):s}}class r extends o{getNumItems(){let t;const{dataSource:i}=this.options;return i?i.length?t=i.length:i.gallery&&(i.items||(i.items=this.l(i.gallery)),i.items&&(t=i.items.length)):t=0,this.dispatch("numItems",{dataSource:i,numItems:t}).numItems}getItemData(t){const{dataSource:i}=this.options;let s;Array.isArray(i)?s=i[t]:i&&i.gallery&&(i.items||(i.items=this.l(i.gallery)),s=i.items[t]);let n=s;return n instanceof Element&&(n=this.m(n)),this.dispatch("itemData",{itemData:n||{},index:t}).itemData}l(t){return this.options.childSelector?t.querySelectorAll(this.options.childSelector)||[]:[t]}m(t){const i={element:t},s="A"===t.tagName?t:t.querySelector("a");if(!s)return i;i.src=s.dataset.pswpSrc||s.href,i.srcset=s.dataset.pswpSrcset,i.w=parseInt(s.dataset.pswpWidth,10),i.h=parseInt(s.dataset.pswpHeight,10);const n=t.querySelector("img");return n&&(i.msrc=n.currentSrc||n.src,i.alt=n.getAttribute("alt")),s.dataset.cropped&&(i.thumbCropped=!0),i}}export default class extends r{constructor(t){super(),this.options=t,this.p=[],this.g={},this.I=0}init(){this.onThumbnailsClick=this.onThumbnailsClick.bind(this),this.options&&this.options.gallerySelector&&document.querySelectorAll(this.options.gallerySelector).forEach(t=>{t.addEventListener("click",this.onThumbnailsClick,!1)})}onThumbnailsClick(t){if(function(t){if(2===t.which||t.ctrlKey||t.metaKey||t.altKey||t.shiftKey)return!0}(t)||window.pswp||!1===window.navigator.onLine)return;let i={x:t.clientX,y:t.clientY};i.x||i.y||(i=null);const s=this.getClickedIndex(t),n={gallery:t.currentTarget};s>=0&&(t.preventDefault(),this.loadAndOpen(s,n,i))}getClickedIndex(t){if(this.options.getClickedIndexFn)return this.options.getClickedIndexFn.call(this,t);const i=t.target,s=t.currentTarget;if(!this.options.childSelector)return 0;{const t=i.closest(this.options.childSelector),n=s.querySelectorAll(this.options.childSelector);if(t)for(let i=0;i<n.length;i++)if(t===n[i])return i}}loadAndOpen(t,i,s){return!window.pswp&&(this.options.index=t,this.options.initialPointerPos=s,this.shouldOpen=!0,this.preload(t,i),!0)}preload(t,i){const{options:h}=this;i&&(h.dataSource=i);const o=[n(h.pswpModule)];Object.keys(this.g).forEach(t=>{o.push(function(t,i){return new Promise(s=>{"string"==typeof i?n(i).then(i=>{s({pluginKey:t,moduleClass:i.default})}).catch(s):s()})}(t,this.g[t]))}),"function"==typeof h.openPromise&&o.push(h.openPromise()),!1!==h.preloadFirstSlide&&t>=0&&s(t,this),h.pswpCSS&&o.push(e(h.pswpCSS)),this.p.forEach(t=>{o.push(e(t))});const r=++this.I;Promise.all(o).then(t=>{if(t.forEach(t=>{t&&t.pluginKey&&t.moduleClass&&(this.g[t.pluginKey]=t.moduleClass)}),this.shouldOpen){const i=t[0];this.M(i,r)}})}M(t,i){if(i!==this.I&&this.shouldOpen)return;if(this.shouldOpen=!1,window.pswp)return;const s=new t.default(null,this.options);s.pluginClasses=this.g,this.pswp=s,window.pswp=s,Object.keys(this.u).forEach(t=>{this.u[t].forEach(i=>{s.on(t,i)})}),s.on("destroy",()=>{this.pswp=null,window.pswp=null}),s.init()}addPlugin(t,i){this.g[t]=i}addCSS(t){this.p.push(t)}destroy(){this.pswp&&this.pswp.close(),this.shouldOpen=!1,this.u=null,document.querySelectorAll(this.options.gallerySelector).forEach(t=>{t.removeEventListener("click",this.onThumbnailsClick,!1)})}}
